namespace _2D_RPG_Negiramen.Models.FileEntries
{
    using _2D_RPG_Negiramen.Models.FileEntries.Locations.UnityAssets;
    using TheLocationOfUnityAssets = _2D_RPG_Negiramen.Models.FileEntries.Locations.UnityAssets;

    /// <summary>
    ///     😁 Unity の Assets フォルダを想定したもの
    /// </summary>
    internal class UnityAssetsDeployment
    {
        // - インターナル静的メソッド

        #region メソッド（Unity の Assets フォルダにファイルを送り込みます）
        /// <summary>
        ///     <pre>
        ///         Unity の 📂 `Assets` フォルダにファイルを送り込みます
        ///     
        ///             📂 例: C:/Users/むずでょ/Documents/Unity Projects/Negiramen Practice/
        ///         👉　└─ 📂 Assets
        ///     </pre>
        /// </summary>
        /// <param name="unityAssetsFolder">Unityの 📂 `Assets` フォルダの場所</param>
        /// <returns>完了した</returns>
        internal static bool PushStartupMemberToUnityAssetsFolder(TheLocationOfUnityAssets.ItsFolder unityAssetsFolder)
        {
            if (!Directory.Exists(unityAssetsFolder.Path.AsStr))
            {
                // TODO Unity の Assets フォルダ―へのパスでなければ失敗
                return false;
            }

            // 無ければ作成
            unityAssetsFolder.YourCircleNameFolder.CreateThisDirectoryIfItDoesNotExist();
            PushStartupMemberToYourCircleNameFolder(unityAssetsFolder.YourCircleNameFolder);

            return true;
        }
        #endregion

        /// <summary>
        ///     <pre>
        ///          Unity の 📂 `Assets/｛あなたのサークル名｝` フォルダにファイルを送り込みます
        ///     
        ///             📂 例: C:/Users/むずでょ/Documents/Unity Projects/Negiramen Practice/
        ///         　　└─ 📂 Assets
        ///         👉　　　└─ 📂 {Your Circle Name}
        ///     </pre>
        /// </summary>
        /// <param name="yourCircleNameFolderPath">あなたのサークル名フォルダ―へのパス</param>
        static void PushStartupMemberToYourCircleNameFolder(TheLocationOfUnityAssets.YourCircleNameFolder yourCircleNameFolder)
        {
            // 無ければ作成
            yourCircleNameFolder.YourWorkNameFolder.CreateThisDirectoryIfItDoesNotExist();
            PushStartupMemberToYourWorkNameFolder(yourCircleNameFolder.YourWorkNameFolder);
        }

        /// <summary>
        ///     <pre>
        ///         Unity の 📂 `Assets/｛あなたのサークル名｝/｛あなたの作品名｝` フォルダにファイルを送り込みます
        ///     
        ///             📂 例: C:/Users/むずでょ/Documents/Unity Projects/Negiramen Practice/
        ///         　　└─ 📂 Assets
        ///         　　　　└─ 📂 {Your Circle Name}
        ///         👉　　　　　└─ 📂 {Your Work Name}
        ///     </pre>
        /// </summary>
        /// <param name="yourWorkNameFolderPath">あなたの作品名フォルダ―へのパス</param>
        static void PushStartupMemberToYourWorkNameFolder(TheLocationOfUnityAssets.YourWorkNameFolder yourWorkNameFolder)
        {
            // 無ければ作成
            yourWorkNameFolder.AutoGeneratedFolder.CreateThisDirectoryIfItDoesNotExist();
            PushStartupMemberToAutoGeneratedFolder(yourWorkNameFolder.AutoGeneratedFolder);
        }

        // - ４階層目

        /// <summary>
        ///     <pre>
        ///         Unity の 📂 `Assets/｛あなたのサークル名｝/｛あなたの作品名｝/Auto Generated` フォルダにファイルを送り込みます
        ///     
        ///             📂 例: C:/Users/むずでょ/Documents/Unity Projects/Negiramen Practice/
        ///         　　└─ 📂 Assets
        ///         　　　　└─ 📂 {Your Circle Name}
        ///         　　　　　　└─ 📂 {Your Work Name}
        ///         👉　　　　　　　└─ 📂 {Auto Generated}
        ///     </pre>
        /// </summary>
        /// <param name="autoGeneratedFolderPath">自動生成フォルダ―へのパス</param>
        static void PushStartupMemberToAutoGeneratedFolder(TheLocationOfUnityAssets.AutoGeneratedFolder autoGeneratedFolder)
        {
            // データ・フォルダ
            autoGeneratedFolder.DataFolder.CreateThisDirectoryIfItDoesNotExist();
            PushStartupMemberToDataFolder(autoGeneratedFolder.DataFolder);

            // エディター・フォルダ
            autoGeneratedFolder.EditorFolder.CreateThisDirectoryIfItDoesNotExist();

            // 画像フォルダ
            autoGeneratedFolder.ImagesFolder.CreateThisDirectoryIfItDoesNotExist();
            PushStartupMemberToImagesFolder(autoGeneratedFolder.ImagesFolder);

            // 材質フォルダ
            autoGeneratedFolder.MaterialsFolder.CreateThisDirectoryIfItDoesNotExist();

            // 映像フォルダ
            autoGeneratedFolder.MoviesFolder.CreateThisDirectoryIfItDoesNotExist();

            // プレファブ・フォルダ
            autoGeneratedFolder.PrefabsFolder.CreateThisDirectoryIfItDoesNotExist();

            // シーン・フォルダ
            autoGeneratedFolder.ScenesFolder.CreateThisDirectoryIfItDoesNotExist();

            // スクリプト・フォルダ
            autoGeneratedFolder.ScriptsFolder.CreateThisDirectoryIfItDoesNotExist();

            // スクリプティング・オブジェクト・フォルダ
            autoGeneratedFolder.ScriptingObjectsFolder.CreateThisDirectoryIfItDoesNotExist();

            // 音フォルダ
            autoGeneratedFolder.SoundsFolder.CreateThisDirectoryIfItDoesNotExist();

            // システム・フォルダ
            autoGeneratedFolder.SystemFolder.CreateThisDirectoryIfItDoesNotExist();

            // テキスト・フォルダ
            autoGeneratedFolder.TextsFolder.CreateThisDirectoryIfItDoesNotExist();
        }

        // - ５階層目

        /// <summary>
        ///     <pre>
        ///         Unity の 📂 `Assets/｛あなたのサークル名｝/｛あなたの作品名｝/Auto Generated/Images` フォルダにファイルを送り込みます
        ///     
        ///             📂 例: C:/Users/むずでょ/Documents/Unity Projects/Negiramen Practice/
        ///         　　└─ 📂 Assets
        ///         　　　　└─ 📂 {Your Circle Name}
        ///         　　　　　　└─ 📂 {Your Work Name}
        ///         　　　　　　　　└─ 📂 {Auto Generated}
        ///         👉　　　　　　　　　└─ 📂 Images
        ///     </pre>
        /// </summary>
        /// <param name="imagesFolder">画像フォルダ―の場所</param>
        static void PushStartupMemberToImagesFolder(TheLocationOfUnityAssets.ImagesFolder imagesFolder)
        {
            // 📂 `Tileset` フォルダ
            imagesFolder.TilesetsFolder.CreateThisDirectoryIfItDoesNotExist();

            CopyTileset(imagesFolder.TilesetsFolder, "86A25699-E391-4D61-85A5-356BA8049881.png");
            CopyTileset(imagesFolder.TilesetsFolder, "E7911DAD-15AC-44F4-A95D-74AB940A19FB.png");
        }

        /// <summary>
        ///     タイルセットをコピー
        /// </summary>
        /// <param name="fileName">ファイル名</param>
        static void CopyTileset(TheLocationOfUnityAssets.ImagesTilesetsFolder tilesetFolder, string fileName)
        {
            var configuration = App.GetOrLoadConfiguration();

            // 画像ファイルのコピー
            {
                var source = Path.Combine(configuration.NegiramenWorkspaceFolder.Path.AsStr, "For Unity Assets", "Images", "Tilesets", fileName);
                var destination = Path.Combine(tilesetFolder.Path.AsStr, fileName);

                if (!File.Exists(destination))
                {
                    // ファイルを複写
                    File.Copy(
                        sourceFileName: source,
                        destFileName: destination);
                }
            }

            // 添付の TOML ファイルのコピー
            {
                var fileStem = Path.GetFileNameWithoutExtension(fileName);
                var source = Path.Combine(configuration.NegiramenWorkspaceFolder.Path.AsStr, "For Unity Assets", "Images", "Tilesets", $"{fileStem}.toml");
                var destination = Path.Combine(tilesetFolder.Path.AsStr, $"{fileStem}.toml");

                if (!File.Exists(destination))
                {
                    // ファイルを複写
                    File.Copy(
                        sourceFileName: source,
                        destFileName: destination);
                }
            }
        }

        /// <summary>
        ///     <pre>
        ///         Data フォルダにファイルを送り込みます
        ///     
        ///             📂 例: C:/Users/むずでょ/Documents/Unity Projects/Negiramen Practice/
        ///         　　└─ 📂 Assets
        ///         　　　　└─ 📂 {Your Circle Name}
        ///         　　　　　　└─ 📂 {Your Work Name}
        ///         　　　　　　　　└─ 📂 {Auto Generated}
        ///         👉　　　　　　　　　└─ 📂 Data
        ///     </pre>
        /// </summary>
        /// <param name="dataFolderPath">データ・フォルダ―へのパス</param>
        static void PushStartupMemberToDataFolder(TheLocationOfUnityAssets.DataFolder dataFolder)
        {
            // CSVN形式ファイル・フォルダへのパス
            dataFolder.CsvFolder.CreateThisDirectoryIfItDoesNotExist();
            PushStartupMemberToDataCSVFolder(dataFolder.CsvFolder);

            // JSON形式ファイル・フォルダへのパス
            dataFolder.JsonFolder.CreateThisDirectoryIfItDoesNotExist();
        }

        // - ６階層目

        /// <summary>
        ///     <pre>
        ///         CSV フォルダのメンバーを準備します
        ///     
        ///             📂 例: C:/Users/むずでょ/Documents/Unity Projects/Negiramen Practice/
        ///         　　└─ 📂 Assets
        ///         　　　　└─ 📂 {Your Circle Name}
        ///         　　　　　　└─ 📂 {Your Work Name}
        ///         　　　　　　　　└─ 📂 {Auto Generated}
        ///         　　　　　　　　　　└─ 📂 Data
        ///         👉　　　　　　　　　　　└─ 📂 CSV
        ///     </pre>
        /// </summary>
        /// <param name="csvFolderPath">ＣＳＶフォルダ―へのパス</param>
        static void PushStartupMemberToDataCSVFolder(TheLocationOfUnityAssets.DataCsvFolder csvFolder)
        {
            // タイルセット
            csvFolder.TilesetsFolder.CreateThisDirectoryIfItDoesNotExist();
        }
    }
}
